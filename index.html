<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8" />
<title>EV Map Lviv</title>

<link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css"/>
<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>

<style>
  html, body { margin:0; padding:0; }
  #map { height:100vh; }
</style>
</head>

<body>
<div id="map"></div>

<script>

const map = L.map('map').setView([49.8397, 24.0297], 11);

L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
  attribution: '&copy; OpenStreetMap contributors'
}).addTo(map);


// üî• –ó–ê–ü–ò–¢ –î–û OPENCHARGEMAP
fetch("https://api.openchargemap.io/v3/poi/?output=json&countrycode=UA&latitude=49.8397&longitude=24.0297&distance=70&distanceunit=KM&maxresults=1000")
.then(response => response.json())
.then(data => {

  console.log("–ó–Ω–∞–π–¥–µ–Ω–æ —Å—Ç–∞–Ω—Ü—ñ–π:", data.length);

  data.forEach(station => {

    if (!station.AddressInfo) return;

    const lat = station.AddressInfo.Latitude;
    const lng = station.AddressInfo.Longitude;
    const name = station.AddressInfo.Title || "EV Station";

    let types = "";
    if (station.Connections) {
      types = station.Connections.map(c => c.ConnectionType?.Title).join(", ");
    }

    L.marker([lat, lng])
      .addTo(map)
      .bindPopup(
        "<b>" + name + "</b><br>" +
        (station.AddressInfo.AddressLine1 || "") + "<br>" +
        "<small>" + types + "</small>"
      );
  });

})
.catch(error => {
  console.error("–ü–æ–º–∏–ª–∫–∞ API:", error);
  alert("–ù–µ –≤–¥–∞–ª–æ—Å—è –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ —Å—Ç–∞–Ω—Ü—ñ—ó.");
});

</script>

</body>
</html>
